<div class="border-box-sizing" id="notebook" tabindex="-1">
<div class="container" id="notebook-container">
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Goals-of-the-Laboratory">Goals of the Laboratory<a class="anchor-link" href="#Goals-of-the-Laboratory">¶</a></h1><p>In this introductory laboratory, we expect students to:</p>
<ol>
<li>Acquire basic knowledge about Python and Matplotlib</li>
<li>Gain familiarity with Juypter Notebooks</li>
<li>Gain familiarity with the PySpark API</li>
</ol>
<p>To achieve such goals, we will go through the following steps:</p>
<ol>
<li><p>In section 1, <strong>IPython</strong> and <strong>Jupyter Notebooks</strong> are introduced to help students understand the environment used to work on projects, including those that are part of the CLOUDS course.</p>
</li>
<li><p>In section 2, we briefly overview <strong>Python</strong> and its syntax. In addition, we cover <strong>Matplotlib</strong>, a very powerful library to plot figures in Python. Finally, we introduce <strong>Pandas</strong>, a python library that is very helpful when manipulating data.</p>
</li>
<li><p>In section 3 we cover the <strong>PySpark</strong> APIs</p>
</li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="1.-Python,-IPython-and-Jupyter-Notebooks">1. Python, IPython and Jupyter Notebooks<a class="anchor-link" href="#1.-Python,-IPython-and-Jupyter-Notebooks">¶</a></h1><p><strong>Python</strong> is a high-level, dynamic, object-oriented programming language. It is a general purpose language, which is designed to be easy to use and easy to read.</p>
<p><strong>IPython</strong> (Interactive Python) is originally developed for Python. Now, it is a command shell for interactive computing supporting multiple programming languages. It offers rich media, shell syntax, tab completion, and history. IPython is based on an architecture that provides parallel and distributed computing. IPython enables parallel applications to be developed, executed, debugged and monitored interactively.</p>
<p><strong>Jupyter Notebooks</strong> are a web-based interactive computational environment for creating IPython notebooks. An IPython notebook is a JSON document containing an ordered list of input/output cells which can contain code, text, mathematics, plots and rich media. Notebooks make data analysis easier to perform, understand and reproduce. All laboratories in this course are prepared as Notebooks. As you can see, in this Notebook, we can put text, images, hyperlinks, source code... The Notebooks can be converted to a number of open standard output formats (HTML, HTML presentation slides, LaTeX, PDF, ReStructuredText, Markdown, Python) through <code>File</code> -&gt; <code>Download As</code> in the web interface. In addition, Jupyter manages the notebooks' versions through a <code>checkpoint</code> mechanism. You can create checkpoint anytime via <code>File -&gt; Save and Checkpoint</code>.</p>
<p><strong>NOTE on Checkpointing:</strong> in this course, we use a peculiar environment to work. We don't have a Notebook server: instead, we create on demand clusters with a Notebook front-end. Since your clusters are <strong>ephemeral</strong> (they are terminated after a predefined amount of time), checkpointing is of little use, for anything else than saving your notebook in your ephemeral environment. It is far better to download regularly your notebooks, and to push them to your git repository.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.1.-Tab-completion">1.1. Tab completion<a class="anchor-link" href="#1.1.-Tab-completion">¶</a></h2><p>Tab completion is a convenient way to explore the structure of any object you're dealing with. Simply type object_name.<tab> to view the suggestion for object's attributes. Besides Python objects and keywords, tab completion also works on file and directory names.</tab></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="err">`</span><span class="n">s</span> <span class="o">=</span> <span class="s2">"test function of tab completion"</span>

<span class="c1"># type s.&lt;TAB&gt; to see the suggestions</span>

<span class="nb">print</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="c1"># Show your experiments working on a string. </span>
<span class="c1"># Try splitting a string into its constituent words, and count the number of words.</span>
<span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">' '</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;built-in method capitalize of str object at 0x7ff034126350&gt;
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt output_prompt">Out[6]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>5</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.2.-System-shell-commands">1.2. System shell commands<a class="anchor-link" href="#1.2.-System-shell-commands">¶</a></h2><p>To run any command in the system shell, simply prefix it with <code>!</code>. For example:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># list all file and directories in the current folder</span>
<span class="o">!</span>ls
<span class="o">!</span>du -lh /* <span class="p">|</span> sort -nr <span class="p">|</span> head -10
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>introduction-lab.ipynb	README.md
du: cannot access â€˜/proc/1047/task/1047/fd/3â€™: No such file or directory
du: cannot access â€˜/proc/1047/task/1047/fdinfo/3â€™: No such file or directory
du: cannot access â€˜/proc/1047/fd/4â€™: No such file or directory
du: cannot access â€˜/proc/1047/fdinfo/4â€™: No such file or directory
du: cannot access â€˜/sys/kernel/slab/nf_conntrack_11631â€™: No such file or directory
1020K	/opt/conda/pkgs/pycparser-2.18-py35_0/lib
1016K	/opt/conda/pkgs/pycparser-2.18-py35_0/lib/python3.5
1016K	/opt/conda/pkgs/asn1crypto-0.22.0-py35_0/lib
1012K	/opt/conda/pkgs/pycparser-2.18-py35_0/lib/python3.5/site-packages
1012K	/opt/conda/pkgs/asn1crypto-0.22.0-py35_0/lib/python3.5
1008K	/opt/conda/pkgs/pycrypto-2.6.1-py35_4/lib/python3.5/site-packages/Crypto/SelfTest
1008K	/opt/conda/pkgs/asn1crypto-0.22.0-py35_0/lib/python3.5/site-packages
1008K	/opt/conda/lib/python3.5/site-packages/notebook/static/components/moment
1008K	/opt/conda/lib/python3.5/site-packages/Crypto/SelfTest
1004K	/usr/share/texlive/texmf-dist/fonts/type1/arkandis/venturissans
sort: write failed: standard output: Broken pipe
sort: write error
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.3.-Magic-functions">1.3. Magic functions<a class="anchor-link" href="#1.3.-Magic-functions">¶</a></h2><p>IPython has a set of predefined <code>magic functions</code> that you can call with a command line style syntax. There are two types of magics, line-oriented and cell-oriented.</p>
<p><strong>Line magics</strong> are prefixed with the <code>%</code> character and work much like OS command-line calls: they get as an argument the rest of the line, <em>where arguments are passed without parentheses or quotes</em>.</p>
<p><strong>Cell magics</strong> are prefixed with a double <code>%%</code>, and they are functions that get as an argument not only the rest of the line, but also the lines below it in a separate argument.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">timeit</span> range(1000)
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>293 ns Â± 2.55 ns per loop (mean Â± std. dev. of 7 runs, 1000000 loops each)
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">timeit</span> x = range(10000)
max(x)
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>351 Âµs Â± 25.6 Âµs per loop (mean Â± std. dev. of 7 runs, 1000 loops each)
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For more information, you can follow this <a href="http://nbviewer.jupyter.org/github/ipython/ipython/blob/1.x/examples/notebooks/Cell%20Magics.ipynb">link</a></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.4.-Debugging">1.4. Debugging<a class="anchor-link" href="#1.4.-Debugging">¶</a></h2><p>Whenever an exception occurs, the call stack is printed out to help you to track down the true source of the problem. It is important to gain familiarity with the call stack, especially when using the PySpark API.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.5.-Additional-features">1.5. Additional features<a class="anchor-link" href="#1.5.-Additional-features">¶</a></h2><p>Jupyter also supports viewing the status of the cluster and interact with the real shell environment.</p>
<p>To do that, you can click on the Logo Jupyter in the up-left corner of each notebook to go to the dashboard:</p>
<p><img src="https://farm2.staticflickr.com/1488/24681339931_733acb3494_b.jpg" width="600px"/></p>
<p>You can easily find out how to use these features, so you're invited to play around!!</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="2.-Python-+-Pandas-+-Matplotlib:-A-great-environment-for-Data-Science">2. Python + Pandas + Matplotlib: A great environment for Data Science<a class="anchor-link" href="#2.-Python-+-Pandas-+-Matplotlib:-A-great-environment-for-Data-Science">¶</a></h1><p>This section aims to help students gain a basic understanding of the python programming language and some of its libraries, including <code>Pandas</code> or <code>Matplotlib</code>.</p>
<p>When working with a small dataset (one that can comfortably fit into a single machine), Pandas and Matplotlib, together with Python are valid alternatives to other popular tools such as R and Matlab. Using such libraries allows to inherit from the simple and clear Python syntax, achieve very good performance, enjoy superior memory management,  error handling, and good package management [<a href="http://ajminich.com/2013/06/22/9-reasons-to-switch-from-matlab-to-python/">1</a>].</p>
<h2 id="2.1.-Python-syntax">2.1. Python syntax<a class="anchor-link" href="#2.1.-Python-syntax">¶</a></h2><p>(This section is for students who did not program in Python before. If you're familiar with Python, please move to the next section: 1.2. Numpy)</p>
<p>When working with Python, the code seems to be simpler than (many) other languages. In this laboratory, we compare the Python syntax to that of Java - another very common language.</p>
<div class="highlight"><pre><span></span><span class="c1">// java syntax</span>
<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span>
<span class="n">string</span> <span class="n">s</span> <span class="o">=</span> <span class="s">"advanced machine learning"</span><span class="o">;</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>
<span class="c1">// you must not forget the semicolon at the end of each sentence</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># python syntax</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">s</span> <span class="o">=</span> <span class="s2">"advanced machine learning"</span>
<span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="c1"># forget about the obligation of commas</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Indentation-&amp;-If-else-syntax">Indentation &amp; If-else syntax<a class="anchor-link" href="#Indentation-&amp;-If-else-syntax">¶</a></h3><p>In python, we don't use <code>{</code> and <code>}</code> to define blocks of codes: instead, we use indentation to do that. <strong>The code within the same block must have the same indentation</strong>. For example, in java, we write:</p>
<div class="highlight"><pre><span></span><span class="n">string</span> <span class="n">language</span> <span class="o">=</span> <span class="s">"Python"</span><span class="o">;</span>

<span class="c1">// the block is surrounded by { and }</span>
<span class="c1">// the condition is in ( and )</span>
<span class="k">if</span> <span class="o">(</span><span class="n">language</span> <span class="o">==</span> <span class="s">"Python"</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
    <span class="n">x</span> <span class="o">+=</span> <span class="mi">10</span><span class="o">;</span>
       <span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">5</span><span class="o">;</span> <span class="c1">// a wrong indentation isn't problem</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">;</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">);</span>

    <span class="c1">// a statement is broken into two line</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">y</span>
        <span class="o">+</span> <span class="n">y</span><span class="o">;</span>

    <span class="c1">// do some stuffs</span>
<span class="o">}</span>
<span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">language</span> <span class="o">==</span> <span class="s">"Java"</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// another block</span>
<span class="o">}</span>
<span class="k">else</span> <span class="o">{</span>
    <span class="c1">// another block</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">language</span> <span class="o">=</span> <span class="s2">"Python"</span>
<span class="k">if</span> <span class="n">language</span> <span class="o">==</span> <span class="s2">"Python"</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">x</span> <span class="o">+=</span> <span class="mi">10</span>
    <span class="n">y</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1"># all statements in the same block must have the same indentation</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
    <span class="p">)</span> <span class="c1"># statements can be on multiple lines, using ( )</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">x</span> 
           <span class="o">+</span> <span class="n">y</span><span class="p">)</span>
    
    <span class="c1"># statements can also be split on multiple lines by using \ at the END of each line</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">y</span> \
        <span class="o">+</span> <span class="n">y</span>
    
    <span class="c1"># do some other stuffs</span>
<span class="k">elif</span> <span class="n">language</span> <span class="o">==</span> <span class="s2">"Java"</span><span class="p">:</span>
    <span class="c1"># another block</span>
    <span class="k">pass</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># another block</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>45
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Ternary-conditional-operator">Ternary conditional operator<a class="anchor-link" href="#Ternary-conditional-operator">¶</a></h3><p>In python, we often see ternary conditional operator, which is used to assign a value to a variable based on some condition. For example, in java, we write:</p>
<div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span>
<span class="c1">// if x &gt; 10, assign y = 5, otherwise, y = 15</span>
<span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="o">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="o">)</span> <span class="o">?</span> <span class="mi">5</span> <span class="o">:</span> <span class="mi">15</span><span class="o">;</span>

<span class="kt">int</span> <span class="n">z</span><span class="o">;</span>
<span class="k">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="o">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="mi">5</span><span class="o">;</span> <span class="c1">// it's not necessary to have { } when the block has only one statement</span>
<span class="k">else</span>
    <span class="n">z</span> <span class="o">=</span> <span class="mi">15</span><span class="o">;</span>
</pre></div>
<p>Of course, although we can easily write these lines of code in an <code>if else</code> block to get the same result, people prefer ternary conditional operator because of simplicity.</p>
<p>In python, we write:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">10</span>
<span class="c1"># a very natural way</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">5</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="k">else</span> <span class="mi">15</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># another way</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="ow">and</span> <span class="mi">5</span> <span class="ow">or</span> <span class="mi">15</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Lists-and-For-loops">Lists and For loops<a class="anchor-link" href="#Lists-and-For-loops">¶</a></h3><p>Another syntax that we should revisit is the <code>for loop</code>. In java, we can write:</p>
<div class="highlight"><pre><span></span><span class="c1">// init an array with 10 integer numbers</span>
<span class="kt">int</span><span class="o">[]</span> <span class="n">array</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[]{</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">7</span><span class="o">,</span> <span class="mi">8</span><span class="o">,</span> <span class="mi">9</span><span class="o">,</span> <span class="mi">10</span><span class="o">};</span>
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">array</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
    <span class="c1">// print the i-th element of array</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">array</span><span class="o">[</span><span class="n">i</span><span class="o">]);</span>
<span class="o">}</span>
</pre></div>
<p>In Python, instead of using an index to help indicating an element, we can access the element directly:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="c1"># Python has no built-in array data structure</span>
<span class="c1"># instead, it uses "list" which is much more general </span>
<span class="c1"># and can be used as a multidimensional array quite easily.</span>
<span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">array</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>1
2
3
4
5
6
7
8
9
10
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we can see, the code is very clean. If you need the index of each element, here's what you should do:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">array</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>0 1
1 2
2 3
3 4
4 5
5 6
6 7
7 8
8 9
9 10
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Actually, Python has no built-in array data structure. It uses the <code>list</code> data structure, which is much more general and can be used as a multidimensional array quite easily. In addition, elements in a list can be retrieved in a very concise way. For example, we create a 2d-array with 4 rows. Each row has 3 elements.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 2-dimentions array with 4 rows, 3 columns</span>
<span class="n">twod_array</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]]</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">twod_array</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"row "</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="s2">":"</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>

<span class="c1"># print row 1 until row 3</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"row 1 until row 3: "</span><span class="p">,</span> <span class="n">twod_array</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>

<span class="c1"># all rows from row 2</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"all rows from row 2: "</span><span class="p">,</span> <span class="n">twod_array</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>

<span class="c1"># all rows until row 2</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"all rows until row 2:"</span><span class="p">,</span> <span class="n">twod_array</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>

<span class="c1"># all rows from the beginning with step of 2. </span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"all rows from the beginning with step of 2:"</span><span class="p">,</span> <span class="n">twod_array</span><span class="p">[::</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Dictionaries">Dictionaries<a class="anchor-link" href="#Dictionaries">¶</a></h3><p>Another useful data structure in Python is a <code>dictionary</code>, which we use to store (key, value) pairs. Here's some example usage of dictionaries:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [14]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'key1'</span><span class="p">:</span> <span class="s1">'value1'</span><span class="p">,</span> <span class="s1">'key2'</span><span class="p">:</span> <span class="s1">'value2'</span><span class="p">}</span>  <span class="c1"># Create a new dictionary with some data</span>
<span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">'key1'</span><span class="p">])</span>       <span class="c1"># Get an entry from a dictionary; prints "value1"</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'key1'</span> <span class="ow">in</span> <span class="n">d</span><span class="p">)</span>     <span class="c1"># Check if a dictionary has a given key; prints "True"</span>
<span class="n">d</span><span class="p">[</span><span class="s1">'key3'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'value3'</span>    <span class="c1"># Set an entry in a dictionary</span>
<span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">'key3'</span><span class="p">])</span>      <span class="c1"># Prints "value3"</span>
<span class="c1"># print(d['key9'])  # KeyError: 'key9' not a key of d</span>
<span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'key9'</span><span class="p">,</span> <span class="s1">'custom_default_value'</span><span class="p">))</span>  <span class="c1"># Get an element with a default; prints "custom_default_value"</span>
<span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'key3'</span><span class="p">,</span> <span class="s1">'custom_default_value'</span><span class="p">))</span>    <span class="c1"># Get an element with a default; prints "value3"</span>
<span class="k">del</span> <span class="n">d</span><span class="p">[</span><span class="s1">'key3'</span><span class="p">]</span>        <span class="c1"># Remove an element from a dictionary</span>
<span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'key3'</span><span class="p">,</span> <span class="s1">'custom_default_value'</span><span class="p">))</span> <span class="c1"># "fish" is no longer a key; prints "custom_default_value"</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>value1
True
value3
custom_default_value
value3
custom_default_value
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Functions">Functions<a class="anchor-link" href="#Functions">¶</a></h3><p>In Python, we can define a function by using keyword <code>def</code>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [15]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">square</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span>

<span class="nb">print</span><span class="p">(</span><span class="n">square</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can apply a function to each element of a list/array by using <code>lambda</code> function. For example, we want to square elements in a list:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [16]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>

<span class="c1"># apply function "square" on each element of "array"</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">square</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">array</span><span class="p">)))</span>

<span class="c1"># or using a for loop, and a list comprehension</span>
<span class="nb">print</span><span class="p">([</span><span class="n">square</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">array</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"orignal array:"</span><span class="p">,</span> <span class="n">array</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>These two above syntaxes are used very often.</p>
<p>If you are not familiar with <strong>list comprehensions</strong>, follow this <a href="http://python-3-patterns-idioms-test.readthedocs.io/en/latest/Comprehensions.html]">link</a>.</p>
<p>We can also put a function <code>B</code> inside a function <code>A</code> (that is, we can have nested functions). In that case, function <code>B</code> is only accessed inside function <code>A</code> (the scope that it's declared). For example:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [17]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># select only the prime number in array</span>
<span class="c1"># and square them</span>
<span class="k">def</span> <span class="nf">filterAndSquarePrime</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    
    <span class="c1"># a very simple function to check a number is prime or not</span>
    <span class="k">def</span> <span class="nf">checkPrime</span><span class="p">(</span><span class="n">number</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">number</span><span class="o">/</span><span class="mi">2</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">number</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>
    
    <span class="n">primeNumbers</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">checkPrime</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">arr</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">square</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">primeNumbers</span><span class="p">)</span>

<span class="c1"># we can not access checkPrime from here</span>
<span class="c1"># checkPrime(5)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">filterAndSquarePrime</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
<span class="nb">list</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Importing-modules,-functions">Importing modules, functions<a class="anchor-link" href="#Importing-modules,-functions">¶</a></h3><p>Modules in Python are packages of code. Putting code into modules helps increasing the reusability and maintainability.
The modules can be nested.
To import a module, we simple use syntax: <code>import &lt;module_name&gt;</code>. Once it is imported, we can use any functions, classes inside it.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [18]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># import module 'math' to uses functions for calculating</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="c1"># print the square root of 16</span>
<span class="nb">print</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>

<span class="c1"># we can create alias when import a module</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sometimes, you only need to import some functions inside a module to avoid loading the whole module into memory. To do that, we can use syntax: <code>from &lt;module&gt; import &lt;function&gt;</code></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># only import function 'sin' in package 'math'</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="k">import</span> <span class="n">sin</span>

<span class="c1"># use the function</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="mi">60</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>That's quite enough for Python. Now, let's practice a little bit.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Question-1">Question 1<a class="anchor-link" href="#Question-1">¶</a></h3><h4 id="Question-1.1">Question 1.1<a class="anchor-link" href="#Question-1.1">¶</a></h4><div class="alert alert-info">
Write a function `checkSquareNumber` to check if a integer number is a square number or not. For example, 16 and 9 are square numbers. 15 isn't square number.
Requirements:

- Input: an integer number

- Output: `True` or `False`

HINT: If the square root of a number is an integer number, it is a square number.
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [15]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="k">def</span> <span class="nf">checkSquareNumber</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="c1"># calculate the square root of x</span>
    <span class="c1"># return True if square root is integer, </span>
    <span class="c1"># otherwise, return False</span>
    <span class="k">if</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">%</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    	<span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
    	<span class="k">return</span> <span class="kc">False</span>
<span class="nb">print</span><span class="p">(</span><span class="n">checkSquareNumber</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">checkSquareNumber</span><span class="p">(</span><span class="mi">250</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>True
False
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Question-1.2">Question 1.2<a class="anchor-link" href="#Question-1.2">¶</a></h4><div class="alert alert-info">
A list `list_numbers` which contains the numbers from 1 to 9999 can be constructed from: 

```python
list_numbers = range(0, 10000)
```

Extract the square numbers in `list_numbers` using function `checkSquareNumber` from question 1.1. How many elements in the extracted list ?
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [24]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">list_numbers</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="n">square_numbers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">checkSquareNumber</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">list_numbers</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">square_numbers</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">square_numbers</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[0, 1, 4, 9, 16, 25, 36, 49, 64, 81, 100, 121, 144, 169, 196, 225, 256, 289, 324, 361, 400, 441, 484, 529, 576, 625, 676, 729, 784, 841, 900, 961, 1024, 1089, 1156, 1225, 1296, 1369, 1444, 1521, 1600, 1681, 1764, 1849, 1936, 2025, 2116, 2209, 2304, 2401, 2500, 2601, 2704, 2809, 2916, 3025, 3136, 3249, 3364, 3481, 3600, 3721, 3844, 3969, 4096, 4225, 4356, 4489, 4624, 4761, 4900, 5041, 5184, 5329, 5476, 5625, 5776, 5929, 6084, 6241, 6400, 6561, 6724, 6889, 7056, 7225, 7396, 7569, 7744, 7921, 8100, 8281, 8464, 8649, 8836, 9025, 9216, 9409, 9604, 9801]
100
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Question-1.3">Question 1.3<a class="anchor-link" href="#Question-1.3">¶</a></h4><div class="alert alert-info">
Using array slicing, select the elements of the list square_numbers, whose index is from 5 to 20 (zero-based index).
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [25]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">square_numbers</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">21</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[25, 36, 49, 64, 81, 100, 121, 144, 169, 196, 225, 256, 289, 324, 361, 400]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, we will take a quick look on Numpy - a powerful module of Python.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2.2.-Numpy">2.2. Numpy<a class="anchor-link" href="#2.2.-Numpy">¶</a></h2><p>Numpy is the core library for scientific computing in Python. It provides a high-performance multidimensional array object, and tools for working with these arrays.</p>
<h3 id="2.2.1.-Array">2.2.1. Array<a class="anchor-link" href="#2.2.1.-Array">¶</a></h3><p>A numpy array is a grid of values, all of <strong>the same type</strong>, and is indexed by a tuple of nonnegative integers. Thanks to the same type property, Numpy has the benefits of <a href="https://en.wikipedia.org/wiki/Locality_of_reference">locality of reference</a>. Besides, many other Numpy operations are implemented in C, avoiding the general cost of loops in Python, pointer indirection and per-element dynamic type checking. So, the speed of Numpy is often faster than using built-in datastructure of Python. When working with massive data with computationally expensive tasks, you should consider to use Numpy.</p>
<p>The number of dimensions is the <code>rank</code> of the array; the <code>shape</code> of an array is a tuple of integers giving the size of the array along each dimension.</p>
<p>We can initialize numpy arrays from nested Python lists, and access elements using square brackets:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [26]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Create a rank 1 array</span>
<span class="n">rank1_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"type of rank1_array:"</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">rank1_array</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"shape of rank1_array:"</span><span class="p">,</span> <span class="n">rank1_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"elements in rank1_array:"</span><span class="p">,</span> <span class="n">rank1_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rank1_array</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">rank1_array</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="c1"># Create a rank 2 array</span>
<span class="n">rank2_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"shape of rank2_array:"</span><span class="p">,</span> <span class="n">rank2_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rank2_array</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">rank2_array</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">rank2_array</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>type of rank1_array: &lt;class 'numpy.ndarray'&gt;
shape of rank1_array: (3,)
elements in rank1_array: 1 2 3
shape of rank2_array: (2, 3)
1 2 4
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2.2.2.-Array-slicing">2.2.2. Array slicing<a class="anchor-link" href="#2.2.2.-Array-slicing">¶</a></h3><p>Similar to Python lists, numpy arrays can be sliced. The different thing is that you must specify a slice for each dimension of the array because arrays may be multidimensional.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [27]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">]])</span>

<span class="c1"># Use slicing to pull out the subarray consisting of the first 2 rows</span>
<span class="c1"># and columns 1 and 2</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">m_array</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

<span class="c1"># we can only use this syntax with numpy array, not python list</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"value at row 0, column 1:"</span><span class="p">,</span> <span class="n">m_array</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="c1"># Rank 1 view of the second row of m_array  </span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"the second row of m_array:"</span><span class="p">,</span> <span class="n">m_array</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>

<span class="c1"># print element at position (0,2) and (1,3)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m_array</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[[2 3]
 [6 7]]
value at row 0, column 1: 2
the second row of m_array: [5 6 7 8]
[3 8]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2.2.3.-Boolean-array-indexing">2.2.3. Boolean array indexing<a class="anchor-link" href="#2.2.3.-Boolean-array-indexing">¶</a></h3><p>We can use boolean array indexing to check whether each element in the array satisfies a condition or use it to do filtering.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [28]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">]])</span>

<span class="c1"># Find the elements of a that are bigger than 2</span>
<span class="c1"># this returns a numpy array of Booleans of the same</span>
<span class="c1"># shape as m_array, where each value of bool_idx tells</span>
<span class="c1"># whether that element of a is &gt; 3 or not</span>
<span class="n">bool_idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">m_array</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bool_idx</span> <span class="p">,</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># We use boolean array indexing to construct a rank 1 array</span>
<span class="c1"># consisting of the elements of a corresponding to the True values</span>
<span class="c1"># of bool_idx</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m_array</span><span class="p">[</span><span class="n">bool_idx</span><span class="p">],</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># We can combine two statements</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m_array</span><span class="p">[</span><span class="n">m_array</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">],</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># select elements with multiple conditions</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m_array</span><span class="p">[(</span><span class="n">m_array</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">m_array</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[[False False False  True]
 [ True  True  True  True]
 [ True  True  True  True]] 

[ 4  5  6  7  8  9 10 11 12] 

[ 4  5  6  7  8  9 10 11 12] 

[ 4  6  8 10 12]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2.2.4.-Datatypes">2.2.4. Datatypes<a class="anchor-link" href="#2.2.4.-Datatypes">¶</a></h3><p>Remember that the elements in a numpy array have the same type. When constructing arrays, Numpy tries to guess a datatype when you create an array However, we can specify the datatype explicitly via an optional argument.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [29]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># let Numpy guess the datatype</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x1</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

<span class="c1"># force the datatype be float64</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x2</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>int64
float64
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2.2.5.-Array-math">2.2.5. Array math<a class="anchor-link" href="#2.2.5.-Array-math">¶</a></h3><p>Similar to Matlab or R, in Numpy, basic mathematical functions operate elementwise on arrays, and are available both as operator overloads and as functions in the numpy module.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [30]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="c1"># mathematical function is used as operator</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"x + y ="</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># mathematical function is used as function</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"np.add(x, y)="</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Unlike MATLAB, * is elementwise multiplication</span>
<span class="c1"># not matrix multiplication</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"x * y ="</span><span class="p">,</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="p">,</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"np.multiply(x, y)="</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"x*2="</span><span class="p">,</span> <span class="n">x</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># to multiply two matrices, we use dot function</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"x.dot(y)="</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"np.dot(x, y)="</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Elementwise square root</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"np.sqrt(x)="</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>x + y = [[  6.   8.]
 [ 10.  12.]] 

np.add(x, y)= [[  6.   8.]
 [ 10.  12.]] 

x * y = [[  5.  12.]
 [ 21.  32.]] 

np.multiply(x, y)= [[  5.  12.]
 [ 21.  32.]] 

x*2= [[ 2.  4.]
 [ 6.  8.]] 

x.dot(y)= [[ 19.  22.]
 [ 43.  50.]] 

np.dot(x, y)= [[ 19.  22.]
 [ 43.  50.]] 

np.sqrt(x)= [[ 1.          1.41421356]
 [ 1.73205081  2.        ]] 

</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that unlike MATLAB, <code>*</code> is elementwise multiplication, not matrix multiplication. We instead use the <code>dot</code> function to compute inner products of vectors, to multiply a vector by a matrix, and to multiply matrices. In what follows, we work on a few more examples to reiterate the concept.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [31]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># declare two vectors</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span>

<span class="c1"># Inner product of vectors</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"v.dot(w)="</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"np.dot(v, w)="</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>

<span class="c1"># Matrix / vector product</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"x.dot(v)="</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"np.dot(x, v)="</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>

<span class="c1"># Matrix / matrix product</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"x.dot(y)="</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"np.dot(x, y)="</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>v.dot(w)= 219
np.dot(v, w)= 219
x.dot(v)= [ 29.  67.]
np.dot(x, v)= [ 29.  67.]
x.dot(y)= [[ 19.  22.]
 [ 43.  50.]]
np.dot(x, y)= [[ 19.  22.]
 [ 43.  50.]]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Additionally, we can do other aggregation computations on arrays such as <code>sum</code>, <code>nansum</code>, or <code>T</code>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [32]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>

<span class="c1"># Compute sum of all elements</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="c1"># Compute sum of each column</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>

<span class="c1"># Compute sum of each row</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

<span class="c1"># transpose the matrix</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

<span class="c1"># Note that taking the transpose of a rank 1 array does nothing:</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>  <span class="c1"># Prints "[1 2 3]"</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>10
[4 6]
[3 7]
[[1 3]
 [2 4]]
[1 2 3]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Question-2">Question 2<a class="anchor-link" href="#Question-2">¶</a></h3><p>Given a 2D array:</p>
<pre><code> 1  2  3  4
 5  6  7  8 
 9 10 11 12
13 14 15 16</code></pre>
<h4 id="Question-2.1">Question 2.1<a class="anchor-link" href="#Question-2.1">¶</a></h4><div class="alert alert-info">
Print the all odd numbers in this array using `Boolean array indexing`.
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [33]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">array_numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">]</span>
    <span class="p">])</span>

<span class="n">bool_idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">array_numbers</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">array_numbers</span><span class="p">[</span><span class="n">bool_idx</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[ 1  3  5  7  9 11 13 15]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Question-2.2">Question 2.2<a class="anchor-link" href="#Question-2.2">¶</a></h4><div class="alert alert-info">
Extract the second row and the third column in this array using `array slicing`.
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [34]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Extract the second row</span>
<span class="nb">print</span><span class="p">(</span><span class="n">array_numbers</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
<span class="c1">#The third column</span>
<span class="nb">print</span><span class="p">(</span><span class="n">array_numbers</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[5 6 7 8]
[ 3  7 11 15]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Question-2.3">Question 2.3<a class="anchor-link" href="#Question-2.3">¶</a></h4><div class="alert alert-info">
Calculate the sum of diagonal elements.
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [35]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">sum</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">array_numbers</span><span class="p">)):</span>
    <span class="nb">sum</span> <span class="o">+=</span> <span class="n">array_numbers</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">sum</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>34
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Question-2.4">Question 2.4<a class="anchor-link" href="#Question-2.4">¶</a></h4><div class="alert alert-info">
Print elementwise multiplication of the first row and the last row using numpy's functions.

Print the inner product of these two rows.
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [36]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Print elementwise multiplication of the first row and the last row</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">array_numbers</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">array_numbers</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">array_numbers</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]))</span>
<span class="c1"># Print the inner product of these two rows. </span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">array_numbers</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">array_numbers</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">array_numbers</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[13 28 45 64]
150
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2.3.-Matplotlib">2.3. Matplotlib<a class="anchor-link" href="#2.3.-Matplotlib">¶</a></h2><p>As its name indicates, Matplotlib is a plotting library. It provides both a very quick way to visualize data from Python and publication-quality figures in many formats. The most important function in matplotlib is <code>plot</code>, which allows you to plot 2D data.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'custom y label'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
AElFTkSuQmCC
"/>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this case, we provide a single list or array to the <code>plot()</code> command, matplotlib assumes it is a sequence of y values, and automatically generates the x values for us. Since python ranges start with 0, the default x vector has the same length as y but starts with 0. Hence the x data are [0,1,2,3].</p>
<p>In the next example, we plot figure with both x and y data. Besides, we want to draw dashed lines instead of the solid in default.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [38]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span> <span class="s1">'r--'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span> <span class="n">align</span><span class="o">=</span><span class="s1">'center'</span><span class="p">)</span>
<span class="c1"># labels of each column bar</span>
<span class="n">x_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Type 1"</span><span class="p">,</span> <span class="s2">"Type 2"</span><span class="p">,</span> <span class="s2">"Type 3"</span><span class="p">,</span> <span class="s2">"Type 4"</span><span class="p">]</span>
<span class="c1"># assign labels to the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">x_labels</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
/wPIMI4cMdKV4AAAAABJRU5ErkJggg==
"/>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
rkJggg==
"/>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we want to merge two figures into a single one, subplot is the best way to do that. For example, we want to put two figures in a stack vertically, we should define a grid of plots with 2 rows and 1 column. Then, in each row, a single figure is plotted.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Set up a subplot grid that has height 2 and width 1,</span>
<span class="c1"># and set the first such subplot as active.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span> <span class="s1">'r--'</span><span class="p">)</span>

<span class="c1"># Set the second subplot as active, and make the second plot.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">16</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"/>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For more examples, please visit the <a href="http://matplotlib.org/1.5.1/examples/index.html">homepage</a> of Matplotlib.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Question-3">Question 3<a class="anchor-link" href="#Question-3">¶</a></h3><p>Given a list of numbers from 0 to 9999.</p>
<h4 id="Question-3.1">Question 3.1<a class="anchor-link" href="#Question-3.1">¶</a></h4><div class="alert alert-info">
Calculate the histogram of numbers divisible by 3, 7, 11 in the list respectively.

( Or in other words, how many numbers divisible by 3, 7, 11 in the list respectively ?)
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [40]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10000</span><span class="p">))</span>
<span class="n">divisors</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span>
<span class="n">histogram</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">arr</span> <span class="o">%</span> <span class="n">divisors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">divisors</span><span class="p">))</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">histogram</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[3334, 1429, 910]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Question-3.2">Question 3.2<a class="anchor-link" href="#Question-3.2">¶</a></h4><div class="alert alert-info">
Plot the histogram in a line chart.
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [42]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="c1"># simple line chart</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">histogram</span><span class="p">)</span>
<span class="n">x_indexes</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">histogram</span><span class="p">))</span>
<span class="n">x_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s1">'Divisible by </span><span class="si">%s</span><span class="s1">'</span> <span class="o">%</span> <span class="n">divisors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">divisors</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">x_indexes</span><span class="p">,</span> <span class="n">x_names</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"/>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Question-3.3">Question 3.3<a class="anchor-link" href="#Question-3.3">¶</a></h4><div class="alert alert-info">
Plot the histogram in a bar chart.
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [43]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># char chart with x-lables</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span> <span class="n">x_indexes</span><span class="p">,</span> <span class="n">histogram</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">'center'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">x_indexes</span><span class="p">,</span> <span class="n">x_names</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
mCEvSQ37f5hMiQ0X697WAAAAAElFTkSuQmCC
"/>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2.4.-Pandas">2.4. Pandas<a class="anchor-link" href="#2.4.-Pandas">¶</a></h2><p>Pandas is an open source library providing high-performance, easy-to-use data structures and data analysis tools for the Python programming language. Indeed, it is great for data manipulation, data analysis, and data visualization.</p>
<h3 id="2.4.1.-Data-structures">2.4.1. Data structures<a class="anchor-link" href="#2.4.1.-Data-structures">¶</a></h3><p>Pandas introduces two useful (and powerful) structures: <code>Series</code> and <code>DataFrame</code>, both of which are built on top of NumPy.</p>
<h4 id="Series">Series<a class="anchor-link" href="#Series">¶</a></h4><p>A <code>Series</code> is a one-dimensional object similar to an array, list, or even column in a table. It assigns a <em>labeled index</em> to each item in the Series. By default, each item will receive an index label from <code>0</code> to <code>N-1</code>, where <code>N</code> is the number items of <code>Series</code>.</p>
<p>We can create a Series by passing a list of values, and let pandas create a default integer index.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [44]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># create a Series with an arbitrary list</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="s1">'Machine learning'</span><span class="p">,</span> <span class="mf">1.414259</span><span class="p">,</span> <span class="o">-</span><span class="mi">65545</span><span class="p">,</span> <span class="s1">'Happy coding!'</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>0                   3
1    Machine learning
2             1.41426
3              -65545
4       Happy coding!
dtype: object
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Or, an index can be used explicitly when creating the <code>Series</code>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [45]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="s1">'Machine learning'</span><span class="p">,</span> <span class="mf">1.414259</span><span class="p">,</span> <span class="o">-</span><span class="mi">65545</span><span class="p">,</span> <span class="s1">'Happy coding!'</span><span class="p">],</span>
             <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">'Col1'</span><span class="p">,</span> <span class="s1">'Col2'</span><span class="p">,</span> <span class="s1">'Col3'</span><span class="p">,</span> <span class="mf">4.1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Col1                   3
Col2    Machine learning
Col3             1.41426
4.1               -65545
5          Happy coding!
dtype: object
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A <code>Series</code> can be constructed from a dictionary too.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [46]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span>
        <span class="s1">'Col1'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">'Col2'</span><span class="p">:</span> <span class="s1">'Machine learning'</span><span class="p">,</span> 
        <span class="s1">'Col3'</span><span class="p">:</span> <span class="mf">1.414259</span><span class="p">,</span> <span class="mf">4.1</span><span class="p">:</span> <span class="o">-</span><span class="mi">65545</span><span class="p">,</span> 
        <span class="mi">5</span><span class="p">:</span> <span class="s1">'Happy coding!'</span>
    <span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Col1                   3
Col2    Machine learning
4.1               -65545
5          Happy coding!
Col3             1.41426
dtype: object
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can access items in a <code>Series</code> in a same way as <code>Numpy</code>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [47]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span>
        <span class="s1">'Col1'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">'Col2'</span><span class="p">:</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> 
        <span class="s1">'Col3'</span><span class="p">:</span> <span class="mf">1.414259</span><span class="p">,</span> 
        <span class="mf">4.1</span><span class="p">:</span> <span class="o">-</span><span class="mi">65545</span><span class="p">,</span> 
        <span class="mi">5</span><span class="p">:</span> <span class="mi">8</span>
    <span class="p">})</span>

<span class="c1"># get element which has index='Col1'</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"s['Col1']="</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="s1">'Col1'</span><span class="p">],</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># get elements whose index is in a given list</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"s[['Col1', 'Col3', 4.5]]="</span><span class="p">,</span> <span class="n">s</span><span class="p">[[</span><span class="s1">'Col1'</span><span class="p">,</span> <span class="s1">'Col3'</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">]],</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># use boolean indexing for selection</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">s</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">],</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># modify elements on the fly using boolean indexing</span>
<span class="n">s</span><span class="p">[</span><span class="n">s</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">15</span>

<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># mathematical operations can be done using operators and functions.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="mi">10</span><span class="p">,</span>  <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>s['Col1']= 3.0 

s[['Col1', 'Col3', 4.5]]= Col1    3.000000
Col3    1.414259
4.5          NaN
dtype: float64 

Col1    3.000000
5       8.000000
Col3    1.414259
dtype: float64 

Col1       15
Col2      -10
4.1    -65545
5          15
Col3       15
dtype: float64 

Col1       150
Col2      -100
4.1    -655450
5          150
Col3       150
dtype: float64 

Col1           225
Col2           100
4.1     4296147025
5              225
Col3           225
dtype: float64 

</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="DataFrame">DataFrame<a class="anchor-link" href="#DataFrame">¶</a></h4><p>A DataFrame is a tabular data structure comprised of rows and columns, akin to database table, or R's data.frame object. In a loose way, we can also think of a DataFrame as a group of Series objects that share an index (the column names).</p>
<p>We can create a DataFrame by passing a dict of objects that can be converted to series-like.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [48]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'year'</span><span class="p">:</span> <span class="p">[</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">2014</span><span class="p">,</span> <span class="mi">2015</span><span class="p">,</span> <span class="mi">2013</span><span class="p">,</span> <span class="mi">2014</span><span class="p">,</span> <span class="mi">2015</span><span class="p">,</span> <span class="mi">2013</span><span class="p">,</span> <span class="mi">2014</span><span class="p">],</span>
        <span class="s1">'team'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Manchester United'</span><span class="p">,</span> <span class="s1">'Chelsea'</span><span class="p">,</span> <span class="s1">'Asernal'</span><span class="p">,</span> <span class="s1">'Liverpool'</span><span class="p">,</span> <span class="s1">'West Ham'</span><span class="p">,</span> <span class="s1">'Newcastle'</span><span class="p">,</span> <span class="s1">'Machester City'</span><span class="p">,</span> <span class="s1">'Tottenham'</span><span class="p">],</span>
        <span class="s1">'wins'</span><span class="p">:</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
        <span class="s1">'losses'</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">]}</span>
<span class="n">football</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'year'</span><span class="p">,</span> <span class="s1">'team'</span><span class="p">,</span> <span class="s1">'wins'</span><span class="p">,</span> <span class="s1">'losses'</span><span class="p">])</span>
<span class="n">football</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[48]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>year</th>
<th>team</th>
<th>wins</th>
<th>losses</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2013</td>
<td>Manchester United</td>
<td>11</td>
<td>5</td>
</tr>
<tr>
<th>1</th>
<td>2014</td>
<td>Chelsea</td>
<td>8</td>
<td>8</td>
</tr>
<tr>
<th>2</th>
<td>2015</td>
<td>Asernal</td>
<td>10</td>
<td>6</td>
</tr>
<tr>
<th>3</th>
<td>2013</td>
<td>Liverpool</td>
<td>15</td>
<td>1</td>
</tr>
<tr>
<th>4</th>
<td>2014</td>
<td>West Ham</td>
<td>11</td>
<td>5</td>
</tr>
<tr>
<th>5</th>
<td>2015</td>
<td>Newcastle</td>
<td>6</td>
<td>10</td>
</tr>
<tr>
<th>6</th>
<td>2013</td>
<td>Machester City</td>
<td>10</td>
<td>6</td>
</tr>
<tr>
<th>7</th>
<td>2014</td>
<td>Tottenham</td>
<td>4</td>
<td>12</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can store data as a CSV file, or read data from a CSV file.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [49]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># save data to a csv file without the index</span>
<span class="n">football</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">'football.csv'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">from_csv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'football.csv'</span><span class="p">)</span>
<span class="n">from_csv</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[49]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>year</th>
<th>team</th>
<th>wins</th>
<th>losses</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2013</td>
<td>Manchester United</td>
<td>11</td>
<td>5</td>
</tr>
<tr>
<th>1</th>
<td>2014</td>
<td>Chelsea</td>
<td>8</td>
<td>8</td>
</tr>
<tr>
<th>2</th>
<td>2015</td>
<td>Asernal</td>
<td>10</td>
<td>6</td>
</tr>
<tr>
<th>3</th>
<td>2013</td>
<td>Liverpool</td>
<td>15</td>
<td>1</td>
</tr>
<tr>
<th>4</th>
<td>2014</td>
<td>West Ham</td>
<td>11</td>
<td>5</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To read a CSV file with a custom delimiter between values and custom columns' names, we can use parameters <code>sep</code> and <code>names</code> relatively.
Moreover, Pandas also supports to read and write to <a href="http://pandas.pydata.org/pandas-docs/stable/io.html#io-excel">Excel file</a> , sqlite database file, URL,  or even clipboard.</p>
<p>We can have an overview on the data by using functions <code>info</code> and <code>describe</code>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [50]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">football</span><span class="o">.</span><span class="n">info</span><span class="p">(),</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">football</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 8 entries, 0 to 7
Data columns (total 4 columns):
year      8 non-null int64
team      8 non-null object
wins      8 non-null int64
losses    8 non-null int64
dtypes: int64(3), object(1)
memory usage: 320.0+ bytes
None 

</pre>
</div>
</div>
<div class="output_area">
<div class="prompt output_prompt">Out[50]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>year</th>
<th>wins</th>
<th>losses</th>
</tr>
</thead>
<tbody>
<tr>
<th>count</th>
<td>8.000000</td>
<td>8.000000</td>
<td>8.000000</td>
</tr>
<tr>
<th>mean</th>
<td>2013.875000</td>
<td>9.375000</td>
<td>6.625000</td>
</tr>
<tr>
<th>std</th>
<td>0.834523</td>
<td>3.377975</td>
<td>3.377975</td>
</tr>
<tr>
<th>min</th>
<td>2013.000000</td>
<td>4.000000</td>
<td>1.000000</td>
</tr>
<tr>
<th>25%</th>
<td>2013.000000</td>
<td>7.500000</td>
<td>5.000000</td>
</tr>
<tr>
<th>50%</th>
<td>2014.000000</td>
<td>10.000000</td>
<td>6.000000</td>
</tr>
<tr>
<th>75%</th>
<td>2014.250000</td>
<td>11.000000</td>
<td>8.500000</td>
</tr>
<tr>
<th>max</th>
<td>2015.000000</td>
<td>15.000000</td>
<td>12.000000</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Numpy's regular slicing syntax works as well.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [51]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">football</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># show only the teams that have won more than 10 matches from 2014</span>
<span class="nb">print</span><span class="p">(</span><span class="n">football</span><span class="p">[(</span><span class="n">football</span><span class="o">.</span><span class="n">year</span> <span class="o">&gt;=</span> <span class="mi">2014</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">football</span><span class="o">.</span><span class="n">wins</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">)])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>   year               team  wins  losses
0  2013  Manchester United    11       5
1  2014            Chelsea     8       8 

   year      team  wins  losses
2  2015   Asernal    10       6
4  2014  West Ham    11       5
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>An important feature that Pandas supports is <code>JOIN</code>. Very often, the data comes from multiple sources, in multiple files. For example, we have 2 CSV files, one contains the information of Artists, the other contains information of Songs. If we want to query the artist name and his/her corresponding songs, we have to do joining two dataframe.</p>
<p>Similar to SQL, in Pandas, you can do inner join, left outer join, right outer join and full outer join. Let's see a small example. Assume that we have two dataset of singers and songs. The relationship between two datasets is maintained by a constrain on <code>singer_code</code>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [52]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">singers</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'singer_code'</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> 
                           <span class="s1">'singer_name'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'singer_a'</span><span class="p">,</span> <span class="s1">'singer_b'</span><span class="p">,</span> <span class="s1">'singer_c'</span><span class="p">,</span> <span class="s1">'singer_d'</span><span class="p">,</span> <span class="s1">'singer_e'</span><span class="p">]})</span>
<span class="n">songs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'singer_code'</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> 
                           <span class="s1">'song_name'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'song_f'</span><span class="p">,</span> <span class="s1">'song_g'</span><span class="p">,</span> <span class="s1">'song_h'</span><span class="p">,</span> <span class="s1">'song_i'</span><span class="p">,</span> <span class="s1">'song_j'</span><span class="p">]})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">singers</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">songs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>   singer_code singer_name
0            0    singer_a
1            1    singer_b
2            2    singer_c
3            3    singer_d
4            4    singer_e


   singer_code song_name
0            2    song_f
1            2    song_g
2            3    song_h
3            4    song_i
4            5    song_j
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [53]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># inner join</span>
<span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">singers</span><span class="p">,</span> <span class="n">songs</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">'singer_code'</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">'inner'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[53]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>singer_code</th>
<th>singer_name</th>
<th>song_name</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2</td>
<td>singer_c</td>
<td>song_f</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>singer_c</td>
<td>song_g</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>singer_d</td>
<td>song_h</td>
</tr>
<tr>
<th>3</th>
<td>4</td>
<td>singer_e</td>
<td>song_i</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [54]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># left join</span>
<span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">singers</span><span class="p">,</span> <span class="n">songs</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">'singer_code'</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">'left'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[54]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>singer_code</th>
<th>singer_name</th>
<th>song_name</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0</td>
<td>singer_a</td>
<td>NaN</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>singer_b</td>
<td>NaN</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>singer_c</td>
<td>song_f</td>
</tr>
<tr>
<th>3</th>
<td>2</td>
<td>singer_c</td>
<td>song_g</td>
</tr>
<tr>
<th>4</th>
<td>3</td>
<td>singer_d</td>
<td>song_h</td>
</tr>
<tr>
<th>5</th>
<td>4</td>
<td>singer_e</td>
<td>song_i</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [55]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># right join</span>
<span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">singers</span><span class="p">,</span> <span class="n">songs</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">'singer_code'</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">'right'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[55]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>singer_code</th>
<th>singer_name</th>
<th>song_name</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2</td>
<td>singer_c</td>
<td>song_f</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>singer_c</td>
<td>song_g</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>singer_d</td>
<td>song_h</td>
</tr>
<tr>
<th>3</th>
<td>4</td>
<td>singer_e</td>
<td>song_i</td>
</tr>
<tr>
<th>4</th>
<td>5</td>
<td>NaN</td>
<td>song_j</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [56]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># outer join (full join)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">singers</span><span class="p">,</span> <span class="n">songs</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">'singer_code'</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">'outer'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[56]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>singer_code</th>
<th>singer_name</th>
<th>song_name</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0</td>
<td>singer_a</td>
<td>NaN</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>singer_b</td>
<td>NaN</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>singer_c</td>
<td>song_f</td>
</tr>
<tr>
<th>3</th>
<td>2</td>
<td>singer_c</td>
<td>song_g</td>
</tr>
<tr>
<th>4</th>
<td>3</td>
<td>singer_d</td>
<td>song_h</td>
</tr>
<tr>
<th>5</th>
<td>4</td>
<td>singer_e</td>
<td>song_i</td>
</tr>
<tr>
<th>6</th>
<td>5</td>
<td>NaN</td>
<td>song_j</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also concatenate two dataframes vertically or horizontally via function <code>concat</code> and parameter <code>axis</code>. This function is useful when we need to append two similar datasets or to put them side by site</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [57]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># concat vertically</span>
<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">singers</span><span class="p">,</span> <span class="n">songs</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[57]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>singer_code</th>
<th>singer_name</th>
<th>song_name</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0</td>
<td>singer_a</td>
<td>NaN</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>singer_b</td>
<td>NaN</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>singer_c</td>
<td>NaN</td>
</tr>
<tr>
<th>3</th>
<td>3</td>
<td>singer_d</td>
<td>NaN</td>
</tr>
<tr>
<th>4</th>
<td>4</td>
<td>singer_e</td>
<td>NaN</td>
</tr>
<tr>
<th>0</th>
<td>2</td>
<td>NaN</td>
<td>song_f</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>NaN</td>
<td>song_g</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>NaN</td>
<td>song_h</td>
</tr>
<tr>
<th>3</th>
<td>4</td>
<td>NaN</td>
<td>song_i</td>
</tr>
<tr>
<th>4</th>
<td>5</td>
<td>NaN</td>
<td>song_j</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [58]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># concat horizontally</span>
<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">singers</span><span class="p">,</span> <span class="n">songs</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[58]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>singer_code</th>
<th>singer_name</th>
<th>singer_code</th>
<th>song_name</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0</td>
<td>singer_a</td>
<td>2</td>
<td>song_f</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>singer_b</td>
<td>2</td>
<td>song_g</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>singer_c</td>
<td>3</td>
<td>song_h</td>
</tr>
<tr>
<th>3</th>
<td>3</td>
<td>singer_d</td>
<td>4</td>
<td>song_i</td>
</tr>
<tr>
<th>4</th>
<td>4</td>
<td>singer_e</td>
<td>5</td>
<td>song_j</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When computing descriptive statistic, we usually need to aggregate data by each group. For example, to answer the question "how many songs each singer has?", we have to group data by each singer, and then calculate the number of songs in each group. Not that the result must contain the statistic of all singers in database (even if some of them have no song)</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [59]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">singers</span><span class="p">,</span> <span class="n">songs</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">'singer_code'</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">'left'</span><span class="p">)</span>

<span class="c1"># count the values of each column in group</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'singer_code'</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># count only song_name</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'singer_code'</span><span class="p">)</span><span class="o">.</span><span class="n">song_name</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># count song name but ignore duplication, and order the result</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'singer_code'</span><span class="p">)</span><span class="o">.</span><span class="n">song_name</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>             singer_name  song_name
singer_code                        
0                      1          0
1                      1          0
2                      2          2
3                      1          1
4                      1          1


singer_code
0    0
1    0
2    2
3    1
4    1
Name: song_name, dtype: int64


singer_code
0    0
1    0
3    1
4    1
2    2
Name: song_name, dtype: int64
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Question-4">Question 4<a class="anchor-link" href="#Question-4">¶</a></h3><p>We have two datasets about music: <a href="https://github.com/michiard/AML-COURSE/blob/master/data/song.tsv">song</a> and <a href="https://github.com/michiard/AML-COURSE/blob/master/data/album.tsv">album</a>.</p>
<p>In the following questions, you <strong>have to</strong> use Pandas to load data and write code to answer these questions.</p>
<h4 id="Question-4.1">Question 4.1<a class="anchor-link" href="#Question-4.1">¶</a></h4><div class="alert alert-info">
Load both dataset into two dataframes and print the information of each dataframe

**HINT**: 

- You can click button `Raw` on the github page of each dataset and copy the URL of the raw file.
- The dataset can be load by using function `read_table`. For example: `df = pd.read_table(raw_url, sep='\t')`
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [15]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">songdb_url</span> <span class="o">=</span> <span class="s1">'https://raw.githubusercontent.com/DistributedSystemsGroup/Algorithmic-Machine-Learning/master/data/song.tsv'</span>
<span class="n">albumdb_url</span> <span class="o">=</span> <span class="s1">'https://raw.githubusercontent.com/DistributedSystemsGroup/Algorithmic-Machine-Learning/master/data/album.tsv'</span>
<span class="n">song_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="n">songdb_url</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">'</span><span class="se">\t</span><span class="s1">'</span><span class="p">)</span> 
<span class="n">album_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="n">albumdb_url</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">'</span><span class="se">\t</span><span class="s1">'</span><span class="p">)</span>

<span class="n">album_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">album_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'\s+'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">song_df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">album_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>            Singer                  Song  Album Length
0  Michael Jackson                 2 bad      1   4:07
1  Michael Jackson           Unbreakable      2   6:26
2  Michael Jackson       Don't Walk Away      2   4:25
3  Michael Jackson         Break of Dawn      2   5:33
4     Taylor Swift          All Too Well      5   5:29
5     Taylor Swift             Bad Blood      7   3:19
6     Taylor Swift      Back to December      6   4:54
7  Michael Jackson          Human Nature      4   4:06
8  Michael Jackson          Baby Be Mine      4   4:20
9  Michael Jackson  What More Can I Give    NaN   3:36
   Album_code                                 Album_name  Year
0           1  HIStory: Past, Present and Future, Book I  1995
1           2                                 Invincible  2001
2           3                                        Bad  1986
3           4                                   Thriller  1982
4           5                                        Red  2012
5           6                                  Speak Now  2010
6           7                                       1989  2014
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Question-4.2">Question 4.2<a class="anchor-link" href="#Question-4.2">¶</a></h4><div class="alert alert-info">
How many albums in this datasets ?

How many songs in this datasets ?
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [16]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"number of albums:"</span><span class="p">,</span> <span class="n">album_df</span><span class="o">.</span><span class="n">Album_code</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"number of songs:"</span><span class="p">,</span> <span class="n">song_df</span><span class="o">.</span><span class="n">Song</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>number of albums: 7
number of songs: 10
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Question-4.3">Question 4.3<a class="anchor-link" href="#Question-4.3">¶</a></h4><div class="alert alert-info">
How many distinct singers in this dataset ?
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [17]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"number distinct singers:"</span><span class="p">,</span><span class="n">song_df</span><span class="o">.</span><span class="n">Singer</span><span class="o">.</span><span class="n">nunique</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>number distinct singers: 2
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Question-4.4">Question 4.4<a class="anchor-link" href="#Question-4.4">¶</a></h4><div class="alert alert-info">
Is there any song that doesn't belong to any album ?

Is there any album that has no song ?

**HINT**: 

- To join two datasets on different key names, we use `left_on=` and `right_on=` instead of `on=`.
- Funtion `notnull` and `isnull` help determining the value of a column is missing or not. For example:
`df['song'].isnull()`.
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [18]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fulldf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">song_df</span><span class="p">,</span> <span class="n">album_df</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">'outer'</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">'Album'</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">'Album_code'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Song(s) that doesn't belong to any album"</span><span class="p">,</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fulldf</span><span class="p">[</span><span class="n">fulldf</span><span class="p">[</span><span class="s1">'Song'</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span><span class="o">&amp;</span><span class="n">fulldf</span><span class="p">[</span><span class="s1">'Album'</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Song(s) that doesn't belong to any album 

            Singer                  Song  Album Length  Album_code Album_name  \
9  Michael Jackson  What More Can I Give    NaN   3:36         NaN        NaN   

   Year  
9   NaN  
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span> <span class="s2">"Album that has no song"</span><span class="p">,</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fulldf</span><span class="p">[</span><span class="n">fulldf</span><span class="p">[</span><span class="s1">'Song'</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">fulldf</span><span class="p">[</span><span class="s1">'Album_code'</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Album that has no song 

   Singer Song  Album Length  Album_code Album_name  Year
10    NaN  NaN    NaN    NaN           3        Bad  1986
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Question-4.5">Question 4.5<a class="anchor-link" href="#Question-4.5">¶</a></h4><div class="alert alert-info">
How many songs in each albums of Michael Jackson ?
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [70]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Try thinking like as for map reduce word count!!</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fulldf</span><span class="p">[</span><span class="n">fulldf</span><span class="p">[</span><span class="s1">'Singer'</span><span class="p">]</span><span class="o">==</span><span class="s1">'Michael Jackson'</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fulldf</span><span class="p">[</span><span class="n">fulldf</span><span class="p">[</span><span class="s1">'Singer'</span><span class="p">]</span><span class="o">==</span><span class="s1">'Michael Jackson'</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">'Album'</span><span class="p">])</span><span class="o">.</span><span class="n">Song</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>            Singer                  Song  Album Length  Album_code  \
0  Michael Jackson                 2 bad      1   4:07           1   
1  Michael Jackson           Unbreakable      2   6:26           2   
2  Michael Jackson       Don't Walk Away      2   4:25           2   
3  Michael Jackson         Break of Dawn      2   5:33           2   
7  Michael Jackson          Human Nature      4   4:06           4   
8  Michael Jackson          Baby Be Mine      4   4:20           4   
9  Michael Jackson  What More Can I Give    NaN   3:36         NaN   

                                  Album_name  Year  
0  HIStory: Past, Present and Future, Book I  1995  
1                                 Invincible  2001  
2                                 Invincible  2001  
3                                 Invincible  2001  
7                                   Thriller  1982  
8                                   Thriller  1982  
9                                        NaN   NaN  
Album
1    1
2    3
4    2
Name: Song, dtype: int64
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="3.-PySpark">3. PySpark<a class="anchor-link" href="#3.-PySpark">¶</a></h1><p>Spark is an alternative framework to Hadoop MapReduce, designed to make it easier and quicker to build and run distributed data manipulation algorithms. Spark comes with a library for machine learning (MLLib) and graph algorithms, and also supports real-time streaming and SQL syntax, via Spark Streaming and SparkSQL, respectively. Spark exposes the Spark programming model to Java, Scala, or Python. In Python, we use the PySpark API to interact with Spark.</p>
<p>As discussed in the CLOUDS lectures, every Spark application has a Spark driver. It is the program that declares the transformations and actions on RDDs of data and submits such requests to the cluster manager. Actually, the driver is the program that creates the <code>SparkContext</code>, connecting to a given cluster manager such as  Spark Master, YARN or others. The executors run user code, run computations and can cache data for your application. The <code>SparkContext</code> will create a job that is broken into stages. The stages are broken into tasks which are scheduled by the SparkContext on an executor.</p>
<p>When starting PySpark with command <code>pyspark</code> or using a well configured notebook (such as this one), <code>SparkContext</code> is created automatically in variable <code>sc</code>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [20]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sc</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[20]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<p><b>SparkContext</b></p>
<p><a href="http://10.0.0.30:4040">Spark UI</a></p>
<dl>
<dt>Version</dt>
<dd><code>v2.2.0</code></dd>
<dt>Master</dt>
<dd><code>spark://spark-master0-2830-prod2:7077</code></dd>
<dt>AppName</dt>
<dd><code>pyspark-shell</code></dd>
</dl>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>PySpark uses PySpark RDDs which  are just RDDs of Python objects: like Python lists, they can store objects with mixed types (actually all the objects are instances of <code>PyObject</code>).</p>
<p>When PySpark is started, it also starts a JVM, which is accessible through a socket. PySpark uses <code>Py4J</code> to handle this communication. The JVM works as the actual Spark driver, and loads a <code>JavaSparkContext</code> that communicates with the Spark executors across the cluster. Python API calls to the Spark Context object are then <strong>translated into Java API calls</strong> to the JavaSparkContext. For example, the implementation of PySpark's <code>sc.textFile()</code> dispatches a call to the <code>.textFile</code> method of the <code>JavaSparkContext</code>, which ultimately communicates with the Spark executor JVMs to load the text data from HDFS.</p>
<p><img alt="" src="http://i.imgur.com/YlI8AqEl.png"/></p>
<p>The Spark executors on the cluster start a Python interpreter for each core, with which they communicate data through a pipe when they need to execute user-code. A Python RDD in the local PySpark client corresponds to a <code>PythonRDD</code> object in the local JVM. The data associated with the RDD actually lives in the Spark JVMs as Java objects. For example, running <code>sc.textFile()</code> in the Python interpreter will call the <code>JavaSparkContexts</code> <code>textFile</code> method, which loads the data as Java String objects in the cluster.</p>
<p>When an API call is made on the <code>PythonRDD</code>, any associated code (e.g., Python lambda function) <strong>is serialized and distributed to the executors</strong>. The data is then converted from Java objects to a Python-compatible representation (e.g., pickle objects) and streamed to executor-associated Python interpreters through a pipe. Any necessary Python processing is executed in the interpreter, and the resulting data is stored back as an RDD (as pickle objects by default) in the JVMs.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The data is read easily by using functions of Spark Context. For example, to read a text file and count the number of lines, we can write:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># each line is stored as an element in 'input_file' - a PythonRDD.</span>
<span class="n">input_file</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">textFile</span><span class="p">(</span><span class="s2">"/datasets/gutenberg/gutenberg_tiny.txt"</span><span class="p">)</span>
<span class="n">num_lines</span> <span class="o">=</span> <span class="n">input_file</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"The number of lines in the input file is:"</span><span class="p">,</span> <span class="n">num_lines</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>The number of lines in the input file is: 745613
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3.0.-Preliminaries:-working-with-HDFS-and-using-the-Apache-Spark-Web-UI-to-inspect-jobs,-tasks-and-many-more-metrics">3.0. Preliminaries: working with HDFS and using the Apache Spark Web UI to inspect jobs, tasks and many more metrics<a class="anchor-link" href="#3.0.-Preliminaries:-working-with-HDFS-and-using-the-Apache-Spark-Web-UI-to-inspect-jobs,-tasks-and-many-more-metrics">¶</a></h2><p>Alright, so we have run our first Apache Spark program, and we learned how many lines it contains. But can we obtain some more information about this file? This is what we are going to do next.</p>
<p>As a side note, the reason why we are interested in learning more about our file is that it allows us to understand how the Apache Spark job operates on it. Specifically, we want to learn about its tasks, their performance, and many more interesting metrics and figures, such as for example the Directed Acyclic Graph representing the job. This kind of exercise is highly connected to the content we learned in class, and it's a good way to put in practice some notions that would otherwise remain only theoretical.</p>
<p>Since Apache Spark jobs generally operate on an input file, and that the way this file is stored determines to a large extent the degree of parallelism we can achieve with our Spark program, let's first focus on a few commands to interrogate the HDFS Name Node.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Working-with-HDFS">Working with HDFS<a class="anchor-link" href="#Working-with-HDFS">¶</a></h3><p>A comfortable way to work with HDFS, albeit a bit geeky, is to use the command line. The nice thing about your Jupyter environment is that you can launch a terminal, which will give you access to one of the containers running your environment (the one where the Jupyter Notebook is running).</p>
<p>Next, we will look at our home directory in HDFS. Open up a terminal, or alternatively use some magic functions from the Notebook, and type the following command:</p>
<pre><code>! hdfs dfs ls</code></pre>
<p>NOTE: you'll probably land on an empty directory, as this is the first time you're using our system.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, we'll have a look at the directory we've used for the simple line count example from above:</p>
<pre><code>! hdfs dfs ls /datasets/gutenberg</code></pre>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Question-3.1">Question 3.1<a class="anchor-link" href="#Question-3.1">¶</a></h3><div class="alert alert-info">
Using the hdfs command, inspect the file we've used before, located in /datasets/gutenberg/gutenberg_tiny.txt
</div><ul>
<li>How many HDFS blocks constitute our file?</li>
<li>Where are they located?</li>
<li>What is the replication factor of our file?</li>
</ul>
<p><strong>Hint</strong>: you should lookup for the HDFS command line documentation to learn how to answer the questions above. Look for the sub-command called <code>fsck</code>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Answers-3.1">Answers 3.1<a class="anchor-link" href="#Answers-3.1">¶</a></h3><ul>
<li>Our file is constituted of 1 block.</li>
<li>It is replicated 3 times (replication factor=3) and stored at Datanodes of following IPs:  10.0.0.5, 10.0.0.11, 10.0.0.14 (See hdfs fsck results below)</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span> hdfs fsck /datasets/gutenberg/gutenberg_tiny.txt -files -locations -blocks
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Connecting to namenode via http://hdfs-namenode.zoe:50070
FSCK started by user44 (auth:SIMPLE) from /10.0.0.30 for path /datasets/gutenberg/gutenberg_tiny.txt at Thu Oct 26 11:17:07 UTC 2017
/datasets/gutenberg/gutenberg_tiny.txt 31457280 bytes, 1 block(s):  OK
0. BP-1699471697-10.0.0.2-1454672112057:blk_1074378409_637598 len=31457280 repl=3 [10.0.0.5:50010, 10.0.0.11:50010, 10.0.0.14:50010]

Status: HEALTHY
 Total size:	31457280 B
 Total dirs:	0
 Total files:	1
 Total symlinks:		0
 Total blocks (validated):	1 (avg. block size 31457280 B)
 Minimally replicated blocks:	1 (100.0 %)
 Over-replicated blocks:	0 (0.0 %)
 Under-replicated blocks:	0 (0.0 %)
 Mis-replicated blocks:		0 (0.0 %)
 Default replication factor:	3
 Average block replication:	3.0
 Corrupt blocks:		0
 Missing replicas:		0 (0.0 %)
 Number of data-nodes:		11
 Number of racks:		1
FSCK ended at Thu Oct 26 11:17:07 UTC 2017 in 0 milliseconds


The filesystem under path '/datasets/gutenberg/gutenberg_tiny.txt' is HEALTHY
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Working-with-the-Apache-Spark-Web-UI">Working with the Apache Spark Web UI<a class="anchor-link" href="#Working-with-the-Apache-Spark-Web-UI">¶</a></h3><p>Next, we'll spend some time trying to understand the execution of our job. This requires a good grip on the notions you've learned in class, so you're invited to revise the lecture on Apache Spark.</p>
<p>The Apache Spark Web UI can be used to dissect the life of a job execution.</p>
<ul>
<li>Using the link available from the endpoints that Zoe created for you, open the Web UI: to be precise, we will use the Spark Mater Web UI, which gives you a broad view of your cluster, executors, and jobs.</li>
<li>You'll see information about the worker machines of your cluster (number of cores, available memory, ...), and a list of applications. You'll see one running application, corresponding to the pyspark shell connected to your Jupyter Notebook. Click on its Application ID to inspect all the jobs this application has run.</li>
<li>You will land on a general page with a summary of your pyspark shell application. Follow the <em>Application Detail UI</em>.</li>
</ul>
<p>If this is the first time you execute the Notebook cell with the simple "line counting" job, you will see a single item in the job list. Pay attention to the job name: it corresponds to the name of the <strong>Action</strong> that fired the job, that is, the <code>count</code> action. At this level, you only see a coarse job summary: its submission time, its duration, and so on.</p>
<ul>
<li>Click on the job description. You will land on a page with a great deal of details about your job, starting with its stages (remember, jobs are made of stages, that are in turn made of tasks).</li>
<li>Expand the sections about the <strong>Event Timeline</strong> and the <strong>DAG visualization</strong>.</li>
<li>Next, click on the job stage with the same name as the <strong>Action</strong> <code>count</code> we specified in our code</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Question-3.2">Question 3.2<a class="anchor-link" href="#Question-3.2">¶</a></h3><div class="alert alert-info">
Using the Apache Spark Web UI, as explained above, answer the following questions:
</div><ul>
<li>How many tasks were launched?</li>
<li>What is the duration of each task?</li>
<li>Hown many input bytes where processed by each task? How does this relate to the input file size?</li>
<li>How many workers in total does your cluster have? How many workers were involved in your "line count" job?</li>
<li>Given that we know how many HDFS blocks compose our input file (from Question 3.1), explain the number of tasks your job is broken into.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Answers-3.2">Answers 3.2<a class="anchor-link" href="#Answers-3.2">¶</a></h3><ul>
<li>2 Tasks were launched.</li>
<li>Task ID 0 took 5 seconds and Task ID 1 took 4 seconds.</li>
<li>Task ID 0 input bytes 15.1 MB and Task ID 1 input bytes 15.0 MB. Our file is about 31 MB therefore each task has processed ~half of its bytes.</li>
<li>We have 4 worker in our cluster and only two of them were involved in the count job.</li>
<li>We can observe that Spark created automatically 2 partions from HDFS file, each partion is store on a particular worker (worker 2 and 3) in order to help parallelize distributed data processing. On other hand the number of tasks is determined by the number of partitions, for this reason 2 tasks were lauched in our execution.     </li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3.1.-Wordcount-example">3.1. Wordcount example<a class="anchor-link" href="#3.1.-Wordcount-example">¶</a></h2><p>In the example below, we are interested in the top-10 words in terms of frequency of occurrence. To do so, we use a small text file as an input, and we wish to plot the term frequency of such top-10 words using Matplotlib.</p>
<p>First, using the method <code>textFile</code> from the SparkContext <code>sc</code>, we create a RDD of strings. Each string in the RDD is representative for a line in the text file. In a loose way, we can think the first RDD is a RDD of lines.</p>
<p>Because we work on the scope of words, we have to transform <strong>a line</strong> of the current RDD into <strong>multiple words</strong>, each word is an object of the new RDD. This is done by using <code>flatMap</code> function.</p>
<p>Then, a <code>map</code> function transforms <strong>each word</strong> in the RDD into <strong>a single</strong> tuple with 2 components: the word itself and the count of 1. As you might have guessed, this is a PairRDD, where each object is a key-value pair.</p>
<p>We can take advantage of function <code>reduceByKey</code> to sum all frequencies of the same word. Now, each element in the RDD is in the form of: (word, total_frequency). To sort the words by frequency of occurrence, we can use many approaches. One of the simplest approach is swap each tuple such that the frequency becomes the key, and use the <code>sortByKey</code> function.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">words</span> <span class="o">=</span> <span class="p">(</span>
            <span class="c1"># read the text file</span>
            <span class="n">sc</span><span class="o">.</span><span class="n">textFile</span><span class="p">(</span><span class="s2">"/datasets/gutenberg/gutenberg_small.txt"</span><span class="p">)</span><span class="o">.</span><span class="n">repartition</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
            
            <span class="c1"># construct words from lines</span>
            <span class="o">.</span><span class="n">flatMap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">line</span><span class="p">:</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
            
            <span class="c1"># map each word to (word, 1)</span>
            <span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    
            <span class="c1"># reduce by key: accumulate sum the freq of the same word</span>
            <span class="o">.</span><span class="n">reduceByKey</span><span class="p">(</span><span class="k">lambda</span> <span class="n">freq1</span><span class="p">,</span> <span class="n">freq2</span><span class="p">:</span> <span class="n">freq1</span> <span class="o">+</span> <span class="n">freq2</span><span class="p">)</span>
            
            <span class="c1"># swap (word, freq) to (freq, word)</span>
            <span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    
            <span class="c1"># sort result by key DESC</span>
            <span class="o">.</span><span class="n">sortByKey</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
         <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Question-3.3">Question 3.3<a class="anchor-link" href="#Question-3.3">¶</a></h3><div class="alert alert-info">
Using both the terminal and the Apache Spark Web UI, as explained above, answer the following questions:
</div><ul>
<li>What is the size of the input file?</li>
<li>How many blocks the input file is broken into? What is the block size?</li>
<li>How many tasks execute in parallel?</li>
<li>How many jobs were launched upon the execution of the code above? Why (note that there are no actions!)?</li>
<li>What does a <strong>"skipped"</strong> stage mean?</li>
<li>What is the number of shuffled bytes? How does this compare to the number of input bytes?</li>
<li>Do you think Spark is doing a good job in balancing the load across the workers? What can go wrong with load balancing?</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span> hdfs fsck /datasets/gutenberg/gutenberg_small.txt
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Connecting to namenode via http://hdfs-namenode.zoe:50070
FSCK started by user44 (auth:SIMPLE) from /10.0.0.68 for path /datasets/gutenberg/gutenberg_small.txt at Thu Oct 26 15:20:56 UTC 2017
.Status: HEALTHY
 Total size:	3000000000 B
 Total dirs:	0
 Total files:	1
 Total symlinks:		0
 Total blocks (validated):	23 (avg. block size 130434782 B)
 Minimally replicated blocks:	23 (100.0 %)
 Over-replicated blocks:	0 (0.0 %)
 Under-replicated blocks:	0 (0.0 %)
 Mis-replicated blocks:		0 (0.0 %)
 Default replication factor:	3
 Average block replication:	3.0
 Corrupt blocks:		0
 Missing replicas:		0 (0.0 %)
 Number of data-nodes:		11
 Number of racks:		1
FSCK ended at Thu Oct 26 15:20:56 UTC 2017 in 0 milliseconds


The filesystem under path '/datasets/gutenberg/gutenberg_small.txt' is HEALTHY
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Answer-3.3">Answer 3.3<a class="anchor-link" href="#Answer-3.3">¶</a></h3><ul>
<li>The file is ~3GB.</li>
<li>The file is broken to 23 blocks of size 130434782 Bytes.</li>
<li>The job is broken to 3 stages, in the first stage (0) 23 tasks were executing in parallel as the the data was broken to 23 partitions (23 blocks file). The two subsequent stages  (reduceByKey &amp; sortByKey) had 16 tasks running in parallel because the input file has been split into 16 partitions in the first stage ( repartition(16))</li>
<li>Two jobs were launched. Although, by definition, sortByKey is not an action, its implementation requires scala Partitionner to call rdd.count() action (source: internet). Also, if we look at the detailed description of that third task, we see that there's a call to rdd.collect(), which might explain triggering two spark jobs.</li>
<li>A skipped stage means that the resulting rdd had already been calculated and cached. Re-executing stage is useless at this point, so it is skipped and the data is only fetched from cache memory.</li>
<li>After the first stage 2.1GB has been shuffled, and only 369.6MB after the second one. The shuffling tries to store every rdd pairs of the same key in the same machine, so what it shuffles (Shuffle Write) is only data that needed to be moved from a machine to another. That explains why shuffled bytes in first stage are less than the size of input data, and also why the number of bytes shuffled in next stage is even more smaller as the data is already pretty much shuffled.</li>
<li>Yes, Spark distributes fairly the work loads across the workers. However, if a job takes too much time to execute, it delays others because it keeps all the resources to itself, this is why a job scheduler comes in handy.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now the top-10 words are collected and sent back to the driver by using function <code>take</code>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># top 10 words:</span>
<span class="n">top10</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">top10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[(29556020, 'the'), (18043957, 'of'), (14914748, 'and'), (12892052, 'to'), (9779124, 'a'), (8568854, 'in'), (5143447, 'that'), (4824456, 'was'), (4156700, 'I'), (3915358, 'with')]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The action <code>collect</code> gathers all elements of the RDD (that reside on multiple machines) to the driver (which is running in a single machine), and cast it as a list.</p>
<p><strong>ATTENTION</strong> collecting an RDD in the driver can be problematic: indeed, an RDD can be very big in size (this is why they are distributed across several machines in the first place!) and thus it could deplete the RAM available in the machine running the driver!</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># collect results from executors to the driver</span>
<span class="c1"># results = words.collect()</span>
<span class="c1"># If you want to have a look at the results, don't print them all, for otherwise the notebook size will be too big</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Recall that there are two kinds of functions in Spark: <strong>transformations</strong> and <strong>actions</strong>. All functions <code>map</code>, <code>flatMap</code>, <code>reduceByKey</code>, <code>sortByKey</code> are transformation functions. They are not executed right away when called. Indeed, Spark is lazily evaluated, so nothing gets executed unless the driver invokes actions such as <code>count</code>, <code>take</code>, <code>collect</code>...</p>
<p>RDD transformations allow us to create dependencies between RDDs. Each RDD in the lineage chain (string of dependencies) has a function for calculating its data and has a pointer (dependency) to its parent RDD. Every time we use an RDD, dependencies are computed again from the beginning, which can be costly. Fortunately, we can use the function <code>cache</code> to instruct Spark to checkpoint in RAM (but eventually also on disk) a particular RDD.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's now use the previous results from the execution of our simple Spark word count job, to plot word frequency information.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># extract the frequencies from the result</span>
<span class="n">frequencies</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">top10</span><span class="p">]</span>

<span class="c1"># plot the frequencies</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">frequencies</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"/>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3.2.-Night-flights-example">3.2. Night flights example<a class="anchor-link" href="#3.2.-Night-flights-example">¶</a></h2><p>We have a CSV file which contains the information about flights that took place in the US in 1994.
The data in this file has 29 columns such as <code>year</code>, <code>month</code>, <code>day_of_month</code>, <code>scheduled_departure_time</code>,...
We can have a quick look on the data:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span> hdfs dfs -cat /datasets/airline/1994.csv <span class="p">|</span> head -n <span class="m">10</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Year,Month,DayofMonth,DayOfWeek,DepTime,CRSDepTime,ArrTime,CRSArrTime,UniqueCarrier,FlightNum,TailNum,ActualElapsedTime,CRSElapsedTime,AirTime,ArrDelay,DepDelay,Origin,Dest,Distance,TaxiIn,TaxiOut,Cancelled,CancellationCode,Diverted,CarrierDelay,WeatherDelay,NASDelay,SecurityDelay,LateAircraftDelay
1994,1,7,5,858,900,954,1003,US,227,NA,56,63,NA,-9,-2,CLT,ORF,290,NA,NA,0,NA,0,NA,NA,NA,NA,NA
1994,1,8,6,859,900,952,1003,US,227,NA,53,63,NA,-11,-1,CLT,ORF,290,NA,NA,0,NA,0,NA,NA,NA,NA,NA
1994,1,10,1,935,900,1023,1003,US,227,NA,48,63,NA,20,35,CLT,ORF,290,NA,NA,0,NA,0,NA,NA,NA,NA,NA
1994,1,11,2,903,900,1131,1003,US,227,NA,148,63,NA,88,3,CLT,ORF,290,NA,NA,0,NA,0,NA,NA,NA,NA,NA
1994,1,12,3,933,900,1024,1003,US,227,NA,51,63,NA,21,33,CLT,ORF,290,NA,NA,0,NA,0,NA,NA,NA,NA,NA
1994,1,13,4,NA,900,NA,1003,US,227,NA,NA,63,NA,NA,NA,CLT,ORF,290,NA,NA,1,NA,0,NA,NA,NA,NA,NA
1994,1,14,5,903,900,1005,1003,US,227,NA,62,63,NA,2,3,CLT,ORF,290,NA,NA,0,NA,0,NA,NA,NA,NA,NA
1994,1,15,6,859,900,1004,1003,US,227,NA,65,63,NA,1,-1,CLT,ORF,290,NA,NA,0,NA,0,NA,NA,NA,NA,NA
1994,1,17,1,859,900,955,1003,US,227,NA,56,63,NA,-8,-1,CLT,ORF,290,NA,NA,0,NA,0,NA,NA,NA,NA,NA
cat: Unable to write to output stream.
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this simple example, we are interested only in columns: <code>CRSDepTime</code> (scheduled departure time) and <code>UniqueCarrier</code> (carrier identifier). The values of <code>CRSDepTime</code> are expressed in the format: hhmm (hour-minute).
Assume that a flight is considered as a 'night flight' if its scheduled departed time <code>CRSDepTime</code> is later than 18:00.</p>
<p>Questions:</p>
<ul>
<li>How many night flights do we have in our data ?</li>
<li>How many night flights per unique carrier ? Plot the top-5 of them, in terms of volume</li>
</ul>
<p>First, we read the data and remove the header. Then, from the lines, we extract the information of scheduled departure time and carrier.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [18]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># read the data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">textFile</span><span class="p">(</span><span class="s1">'/datasets/airline/1994.csv'</span><span class="p">)</span>

<span class="c1"># extract information about scheduled departure time and carrier</span>
<span class="c1"># note that the scheduled time must be convert from string to interger number</span>
<span class="k">def</span> <span class="nf">extract_CRSDepTime_Carier</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">","</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">cols</span><span class="p">[</span><span class="mi">5</span><span class="p">]),</span> <span class="n">cols</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span>

<span class="n">header</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>

<span class="c1"># remove header</span>
<span class="n">data_without_header</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">line</span><span class="p">:</span> <span class="n">line</span> <span class="o">!=</span> <span class="n">header</span><span class="p">)</span>

<span class="c1"># create a new RDD with only scheduled departure time and carrier information</span>
<span class="c1"># cache it for later usage</span>
<span class="n">newdata</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">data_without_header</span>
               <span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">extract_CRSDepTime_Carier</span><span class="p">)</span>
               <span class="o">.</span><span class="n">cache</span><span class="p">()</span>
          <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Function <code>filter</code> helps us select only the objects that satisfy a condition. In this case, it creates a new RDD by filtering out the header. We can also use it to select the night flights.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">night_flights</span> <span class="o">=</span> <span class="n">newdata</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">f</span><span class="p">:</span> <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1800</span><span class="p">)</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span>
<span class="n">night_flights</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[19]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>[(2030, 'US'), (2030, 'US'), (2030, 'US')]</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We use <code>cache</code> because we don't want to recalculate <code>night_flights</code> from the beginning every time of using it.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [20]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># filter and count the night flights</span>
<span class="n">num_night_flights</span> <span class="o">=</span> <span class="n">night_flights</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">num_night_flights</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>1078203
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [21]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># group by carrier</span>
<span class="n">night_flights_by_carrier</span> <span class="o">=</span> <span class="n">night_flights</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">mapValues</span><span class="p">(</span><span class="k">lambda</span> <span class="n">flights</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">flights</span><span class="p">))</span>
<span class="c1"># take top 5 carriers</span>
<span class="n">top5_carriers</span> <span class="o">=</span> <span class="n">night_flights_by_carrier</span><span class="o">.</span><span class="n">takeOrdered</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">top5_carriers</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[('DL', 208224), ('US', 170397), ('AA', 142832), ('WN', 124024), ('UA', 113640)]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We use <code>groupBy</code> to cluster flights which belong to the same carrier into a group. In this example, to select the top-5 carriers, we use a method based on the function <code>takeOrder</code>. This function takes the top-<code>k</code> objects ordered by an index: the trick is that we instruct it to use the cumulative counts as the key.</p>
<p>Let's plot a bar chart using Matplotlib. To draw a bar chart, we use function <code>bar</code> which requires two parameters. Each parameter is a list of float values in each dimension.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [22]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># extract the number of flights which will be used as y-values</span>
<span class="n">num_flights</span> <span class="o">=</span> <span class="p">[</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">top5_carriers</span><span class="p">]</span>

<span class="c1"># extract the carriers' names</span>
<span class="n">carrier_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">top5_carriers</span><span class="p">]</span>

<span class="c1"># create `virtual indexes for carriers which will be used as x-values`</span>
<span class="n">carrier_indexes</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">carrier_names</span><span class="p">))</span>

<span class="c1"># plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">carrier_indexes</span><span class="p">,</span> <span class="n">num_flights</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">"center"</span><span class="p">)</span>

<span class="c1"># put x-labels for the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">carrier_indexes</span><span class="p">,</span> <span class="n">carrier_names</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
3YI5gQAAAABJRU5ErkJggg==
"/>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Question-5">Question 5<a class="anchor-link" href="#Question-5">¶</a></h2><h3 id="Question-5.1">Question 5.1<a class="anchor-link" href="#Question-5.1">¶</a></h3><div class="alert alert-info">
Compute how many flights have a scheduled departure time later than 09:00 and before 14:00.
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [37]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># read the data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">textFile</span><span class="p">(</span><span class="s1">'/datasets/airline/1994.csv'</span><span class="p">)</span>

<span class="c1"># extract information about scheduled departure time and carrier</span>
<span class="c1"># note that the scheduled time must be convert from string to interger number</span>
<span class="k">def</span> <span class="nf">extract_CRSDepTime_Carier</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">","</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">cols</span><span class="p">[</span><span class="mi">5</span><span class="p">]),</span> <span class="n">cols</span><span class="p">[</span><span class="mi">16</span><span class="p">])</span>

<span class="n">header</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>

<span class="c1"># remove header</span>
<span class="n">data_without_header</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">line</span><span class="p">:</span> <span class="n">line</span> <span class="o">!=</span> <span class="n">header</span><span class="p">)</span>

<span class="c1"># create RDD with only scheduled departure time and carrier information</span>
<span class="c1"># cache it for later usages</span>
<span class="n">newdata</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">data_without_header</span>
               <span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">extract_CRSDepTime_Carier</span><span class="p">)</span>
               <span class="o">.</span><span class="n">cache</span><span class="p">()</span>
          <span class="p">)</span>

<span class="n">flights</span> <span class="o">=</span> <span class="n">newdata</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">f</span><span class="p">:</span> <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">900</span> <span class="ow">and</span> <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1400</span><span class="p">)</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">flights</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>1625828
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Question-5.2">Question 5.2<a class="anchor-link" href="#Question-5.2">¶</a></h3><div class="alert alert-info">
Compute the cumulative number flights that have a scheduled departure time after 09:00 and before 14:00, for each source airport (origin). Plot the top-5 of such airports.
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [38]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">flights_per_carrier</span> <span class="o">=</span> <span class="n">flights</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="k">lambda</span> <span class="n">line</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">mapValues</span><span class="p">(</span><span class="k">lambda</span> <span class="n">deptimes</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">deptimes</span><span class="p">))</span>

<span class="c1"># take top 5 source airports</span>
<span class="n">top5_source_airport</span> <span class="o">=</span> <span class="n">flights_per_carrier</span><span class="o">.</span><span class="n">takeOrdered</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">line</span><span class="p">:</span> <span class="o">-</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># extract the number of flights which will be used as y-values</span>
<span class="c1"># This is called list comprehension</span>
<span class="n">num_flights</span> <span class="o">=</span> <span class="p">[</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">top5_source_airport</span><span class="p">]</span>

<span class="c1"># create `virtual indexes for carriers which will be used as x-values`</span>
<span class="n">airport_indexes</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">top5_source_airport</span><span class="p">))</span>

<span class="c1"># plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">airport_indexes</span><span class="p">,</span> <span class="n">num_flights</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">"center"</span><span class="p">)</span>

<span class="c1"># extract the carriers' names</span>
<span class="n">airport_names</span> <span class="o">=</span> <span class="p">[</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">top5_source_airport</span><span class="p">]</span>

<span class="c1"># put x-labels for the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">airport_indexes</span><span class="p">,</span> <span class="n">airport_names</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
c/XfPEyjXAAAAABJRU5ErkJggg==
"/>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h1><p>In this lecture, we gained familiarity with the Jupyter Notebook environment, the Python programming language and its modules. In particular, we covered the Python syntax, Numpy - the core library for scientific computing, Matplotlib - a module to plot graphs, Pandas - a data analysis module. Besides, we started to gain practical experience with PySpark, using, for the moment, small data sets.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="References">References<a class="anchor-link" href="#References">¶</a></h1><p>This notebook is inspired from:</p>
<ul>
<li><a href="http://cs231n.github.io/python-numpy-tutorial/">Python Numpy tutorial</a></li>
</ul>
</div>
</div>
</div>
</div>
</div>

